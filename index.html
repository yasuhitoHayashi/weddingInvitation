<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="noindex,nofollow,noimageindex" />
  <title>結婚式のご案内 | 林 靖人・瀧本 理彩</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="canonical" href="https://yasuhitohayashi.github.io/weddingInvitation/">
  <meta property="og:locale" content="ja_JP">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="結婚式のご案内">
  <meta property="og:title" content="結婚式のご案内 | 林 靖人・瀧本 理彩">
  <meta property="og:description" content="2025年11月8日（土）15:00｜金澤神社（石川県金沢市）。ご参列の方はフォームよりご回答ください。">
  <meta property="og:url" content="https://yasuhitohayashi.github.io/weddingInvitation/">
  <meta property="og:image" content="https://yasuhitohayashi.github.io/weddingInvitation/img/ogp.jpg">
  <meta property="og:image:width" content="1200">
</head>

<body>
  <header class="invite">
    <h1>結婚式のご案内</h1>
  </header>

  <main class="grid">
    <section class="card">
      <h2>ごあいさつ</h2>
      <div class="greeting">
        <p>拝啓　あっついですねえ</p>
        <p>このたび私たちは金澤神社にて</p>
        <p>挙式を執り行うことといたしました</p>
        <p>つきましては日頃お世話になっております皆さまに</p>
        <p>感謝の気持ちをこめてささやかながら小宴を催したく存じます</p>
        <p>ご多用中のところ誠に恐縮ではございますが</p>
        <p>ぜひご出席くださいますよう心よりお待ちしております</p>
        <p>ご参列いただける方は下のGoogleフォームから
        <p>ご返信いただけますと幸いです</p>
        <p>2025年8月</p>
        <p>林靖人　瀧本 理彩</p>
      </div>
    </section>

    <section class="card">
      <h2>日程</h2>
      <ul class="date-list">
        <li><strong>2025年11月8日（土）</strong></li>
        <li>14:30 控室集合</li>
        <li>15:00 挙式（神前式）</li>
        <li>16:30 食事会</li>
        左揃え
      </ul>

    <section class="block">
      <p>2025年11月8日（土）</p>
      <p>15:00 挙式｜金澤神社（石川県金沢市）</p>
      <p>14時30分に控室にお越しください</p>
    </section>
    <section class="block">
      <p>16:30 食事会｜金城樓</p>
      <p>近くに兼六園をはじめ金沢らしいスポットがありますのでぜひお立ち寄りください</p>
      <p>金澤神社から金城樓へはバスおよびタクシーをご用意させていただきます</p>
    </section>
    </section>
    <section class="card" id="profile">
      <h2>新郎新婦紹介</h2>
      <div class="profiles">
        <div class="person">
          <img src="img/yh.png" alt="新郎 林 靖人" class="profile-photo">
          <h3>林 靖人</h3>
          <p>1996年5月19日 富山県砺波市生まれ</p>
        </div>
        <div class="person">
          <img src="img/rh.png" alt="新婦 瀧本 理彩" class="profile-photo">
          <h3>瀧本 理彩</h3>
          <p>1996年6月24日 岡山県倉敷市生まれ</p>
        </div>
      </div>
    </section>

    <section id="rsvp" class="card">
      <h2 class="section-title">ご出欠連絡</h2>
      <iframe
      title="ご出欠連絡（Googleフォーム）"
      src="https://docs.google.com/forms/d/e/1FAIpQLSee_b62XsutAqpkugUrPVVb2oflpRt36BgAI9jMnfoxNdoU7w/viewform?embedded=true&hl=ja"
      width="100%" height="1000" frameborder="0" loading="lazy">
      </iframe>
      <p class="muted">
      うまく表示されない場合は
      <a href="https://docs.google.com/forms/d/e/1FAIpQLSee_b62XsutAqpkugUrPVVb2oflpRt36BgAI9jMnfoxNdoU7w/viewform" target="_blank" rel="noopener">こちら</a> を開いてください。
      </p>
    </section>

    <section class="card row">
      <div>
        <h2>会場アクセス（挙式　神前式）</h2>
        <p>金澤神社（石川県金沢市兼六町1-3）</p>
        <iframe title="金澤神社の地図" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d4051.8179984071844!2d136.66024377582747!3d36.56053837231637!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x5ff833869270ab09%3A0x164cd59acafec97c!2z6YeR5r6k56We56S-!5e1!3m2!1sja!2sjp!4v1755406623039!5m2!1sja!2sjp" width="100%" height="420" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        <p><a class="btn" target="_blank" rel="noopener" href="https://maps.google.com/?q=金澤神社">Google マップで開く</a></p>
      </div>
      <div>
        <h2>ご飯会 会場</h2>
        <p>金城樓（石川県金沢市橋場町2-2-23）</p>
        <iframe title="金城樓の地図" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d8102.610250201994!2d136.66428059999996!3d36.5703167!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x5ff8337426b71f79%3A0x6646d54eee81fe32!2z5paZ5Lqt5peF6aSoIOmHkeWfjuaokw!5e1!3m2!1sja!2sjp!4v1755406692335!5m2!1sja!2sjp" width="100%" height="420" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        <p><a class="btn" target="_blank" rel="noopener" href="https://maps.google.com/?q=金城樓">Google マップで開く</a></p>
      </div>
    </section>

    <section class="card" id="hotels">
      <h2>周辺ホテルの目安料金</h2>
      <p>大変恐縮ではございますが宿泊についてはみなさまのご手配でお願い申し上げます</p>
      <p>金城樓さまからホテルへはバスにてお送りさせていただきます</p>
      <p class="muted">※ 表示は目安です（8/13時点楽天トラベル）実際の料金は各ホテルおよび宿泊サイトをご確認ください</p>
      <div id="hotels-status" class="muted" aria-live="polite">読み込み中…</div>
      <div class="table-wrap">
        <table id="hotels-table" class="table" aria-describedby="hotels-status">
          <thead></thead>
          <tbody></tbody>
        </table>
      </div>
      <noscript>
        <p>JavaScriptが無効なため一覧を表示できません<a href="hotels.csv" target="_blank" rel="noopener">CSVファイル</a>をご覧ください</p>
      </noscript>
    </section>

    <section class="card">
      <h2>連絡事項</h2>
      <p>当日の緊急連絡先：
        <img src="img/phone.png" alt="" style="max-width:180px;height:auto;vertical-align:middle;">
      </p>
      <p class="muted">プライバシー保護のためこのページのURLはご招待者様のみに共有してください</p>
    </section>

  </main>

  <script>
  (function(){
    const statusEl = document.getElementById("hotels-status");
    const table    = document.getElementById("hotels-table");
    if (!statusEl || !table) return;

    const thead = table.querySelector("thead");
    const tbody = table.querySelector("tbody");

    // トライ順序: サイト直下 → GitHub raw
    const CANDIDATES = [
      "hotels.csv",
      "https://raw.githubusercontent.com/yasuhitoHayashi/weddingInvitation/main/hotels.csv"
    ];

    function setStatus(msg){ statusEl.textContent = msg; }

    function formatYen(v){
      if (v == null) return "";
      const s = String(v).trim();
      if (!s) return "";
      if (/[^\d.-]/.test(s)) return s; // 非数値はそのまま
      const n = Number(s);
      return Number.isNaN(n) ? s : n.toLocaleString("ja-JP");
    }

    function parseDelimited(text){
      const delimiter = text.includes("\t") ? "\t" : ",";
      const lines = text.replace(/\r\n?/g, "\n").split("\n").filter(l => l.trim() !== "");
      return lines.map(line => line.split(delimiter).map(c => c.trim()));
    }

    function render(rows){
      if (!rows || !rows.length){ setStatus("データがありません。"); return; }
      const headers = rows[0];
      const body = rows.slice(1);

      thead.innerHTML = "";
      const trHead = document.createElement("tr");
      headers.forEach(h => { const th = document.createElement("th"); th.textContent = h; trHead.appendChild(th); });
      thead.appendChild(trHead);

      tbody.innerHTML = "";
      body.forEach(cols => {
        if (cols.every(c => !String(c || "").trim())) return;
        const tr = document.createElement("tr");
        cols.forEach((c, idx) => {
          const td = document.createElement("td");
          const h = headers[idx] || "";
          td.textContent = /(金額|円)/.test(h) ? formatYen(c) : c;
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
      const count = tbody.querySelectorAll("tr").length;
      setStatus(`読み込み完了（${count}件）`);
    }

    async function tryFetch(url){
      try {
        const r = await fetch(url, {cache: "no-store"});
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        const text = await r.text();
        return text;
      } catch (e){
        console.warn("CSV fetch failed:", url, e);
        return null;
      }
    }

    (async () => {
      for (const url of CANDIDATES){
        setStatus(`読み込み中… (${url})`);
        const text = await tryFetch(url);
        if (text){ render(parseDelimited(text)); return; }
      }
      setStatus("読み込みに失敗しました。CSVの公開場所を確認してください（GitHub Pages で公開中か、または raw URL がアクセス可能か）。");
    })();
  })();
  </script>

  <footer class="muted" style="text-align:center; padding:24px 0 60px;">
    © 2025 林 靖人　瀧本 理彩
  </footer>

  

</body>
</html>
